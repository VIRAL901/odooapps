<?xml version="1.0" encoding="UTF-8" ?>
<odoo>
    <template id="project_snippet" name="Projects">
        <section class="container dynamic_search_snippet"
                 style="border: 0px solid white; max-width: 1200px; margin: auto; padding: 20px;">
            <div class="button-group" style="display: flex; justify-content: center; margin: 20px 0;">
                <a href="javascript:void(0)" data-status="all" class="btn btn-secondary filter-btn"
                   style="background-color: #007BFF; color: white; border: none; border-radius: 25px; padding: 10px 20px; margin: 0 10px; text-decoration: none; transition: background-color 0.3s;">
                    All
                </a>
                <a href="javascript:void(0)" data-status="open" class="btn btn-secondary filter-btn"
                   style="background-color: #007BFF; color: white; border: none; border-radius: 25px; padding: 10px 20px; margin: 0 10px; text-decoration: none; transition: background-color 0.3s;">
                    Open
                </a>
                <a href="javascript:void(0)" data-status="process" class="btn btn-secondary filter-btn"
                   style="background-color: #007BFF; color: white; border: none; border-radius: 25px; padding: 10px 20px; margin: 0 10px; text-decoration: none; transition: background-color 0.3s;">
                    Process
                </a>
                <a href="javascript:void(0)" data-status="done" class="btn btn-secondary filter-btn"
                   style="background-color: #007BFF; color: white; border: none; border-radius: 25px; padding: 10px 20px; margin: 0 10px; text-decoration: none; transition: background-color 0.3s;">
                    Done
                </a>
            </div>
            <div
    id="project-container"
    class="project-container"
    style="display: flex; flex-wrap: wrap; gap: 20px;">
    <t t-foreach="sorted_projects" t-as="project">
        <t t-set="projects_per_row" t-value="projects_per_row"/>

        <div
            class="project-card"
            t-att-style="'flex: 0 0 calc(100% / ' + str(projects_per_row) + ' - 20px); max-width: calc(100% / ' + str(projects_per_row) + ' - 20px); background: #fff; border: 1px solid #dee2e6; border-radius: 12px; padding: 15px; box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1); overflow: hidden; cursor: pointer; transition: transform 0.3s, box-shadow 0.3s ease-in-out;'"
            onmouseover="this.style.transform='scale(1.05)'; this.style.boxShadow='0 8px 16px rgba(0, 0, 0, 0.2)';"
            onmouseout="this.style.transform='scale(1)'; this.style.boxShadow='0 4px 8px rgba(0, 0, 0, 0.1)';">

            <!-- Project Image with default image fallback -->
            <t t-if="project.project_image">
                <img
                    t-att-src="'data:image/png;base64,' + project.project_image.decode('utf-8')"
                    alt="Project Image"
                    style="width: 100%; height: 200px; object-fit: cover; border-radius: 8px; transition: transform 0.3s ease-in-out;"/>
            </t>
            <t t-else="">
                <img
                    src="/project_snippet/static/description/default_image.png"
                    alt="Placeholder Image"
                    style="width: 100%; height: 200px; object-fit: cover; border-radius: 8px; opacity: 0.6;"/>
            </t>

            <!-- Project Content -->
            <div class="project-header" style="margin-top: 10px;">
                <h3 class="project-title" style="font-size: 1.2em; font-weight: bold; color: #343a40;">
                    <t t-out="project.name"/>
                </h3>
            </div>

           <t t-if="project.description">
                <div class="project-desc" style="margin-top: 10px; font-size: 0.9em; color: #6c757d; overflow: hidden; white-space: nowrap; text-overflow: ellipsis;">
                    <h3 class="project-title" style="font-size: 1.2em; font-weight: bold; color: #343a40; white-space: normal; overflow: hidden; text-overflow: ellipsis;">
                        Description:
                        <t t-out="project.description"/>
                    </h3>
                </div>
            </t>
        </div>
    </t>
</div>
        </section>


        <script type="text/javascript">
            document.addEventListener('DOMContentLoaded', function() {
            const buttons = document.querySelectorAll('.filter-btn');
            const projectContainer = document.getElementById('project-container');

            function fetchProjects(status) {
            fetch(`/project_snippet?status=${status}`)
            .then(response => response.text())
            .then(html => {
            const tempDiv = document.createElement('div');
            tempDiv.innerHTML = html;
            const newProjects = tempDiv.querySelector('#project-container');
            if(newProjects){
            projectContainer.innerHTML = newProjects.innerHTML;
            }
            })

            .catch(error => console.error('Error fetching project data:', error));
            }

            buttons.forEach(button => {
            button.addEventListener('click', function() {
            const status = this.getAttribute('data-status');
            fetchProjects(status);
            });
            });

            // Trigger click on "All" button by default to show all projects initially
            fetchProjects('all');
            });
        </script>

    </template>
</odoo>